/*
		NINJA BORG BOARD
*/

/obj/item/borg/upgrade/transform/ninja
	name = "unknown cyborg module"
	icon_state = "module_illegal"
	desc = "A module picking system, capable of using stored matter to build itself out into a fresh cyborg configuration. This one has no serial number, and the only identifying mark is that of a black spider."
	new_module = /obj/item/robot_module/ninja

/*
		NINJA BORG
*/

/obj/item/robot_module/ninja
	name = "Ninja"
	basic_modules = list(
		/obj/item/melee/sword/weebstick,
		/obj/item/melee/baton/loaded,
		/obj/item/gun/energy/disabler/cyborg,
		/obj/item/gun/energy/laser/cyborg,
		/obj/item/assembly/flash/cyborg,
		/obj/item/restraints/handcuffs,
		/obj/item/extinguisher/mini,
		)
	cyborg_base_icon = "mmekaninja"
	moduleselect_icon = "malf"
	can_be_pushed = FALSE
	hat_offset = 3

/obj/item/robot_module/ninja/be_transformed_to(obj/item/robot_module/old_module)
	var/mob/living/silicon/robot/R = loc
	var/static/list/ninja_icons
	if(!ninja_icons)
		ninja_icons = list(
		"NINJA - F" = image(icon = 'modular_pentest/modules/robots/icons/mob/numekasf.dmi', icon_state = "fmekaninja"),
		"NINJA - M" = image(icon = 'modular_pentest/modules/robots/icons/mob/numekasm.dmi', icon_state = "mmekaninja"),
		)
		ninja_icons = sortList(ninja_icons)
	var/ninja_borg_icon = show_radial_menu(R, R , ninja_icons, custom_check = CALLBACK(src, PROC_REF(check_menu), R), radius = 42, require_near = TRUE)
	switch(ninja_borg_icon)
		if("NINJA - F")
			cyborg_base_icon = "fmekaninja"
			cyborg_icon_override = 'modular_pentest/modules/robots/icons/mob/numekasf.dmi'
			special_light_key = "fmekaninja"
		if("NINJA - M")
			cyborg_base_icon = "mmekaninja"
			cyborg_icon_override = 'modular_pentest/modules/robots/icons/mob/numekasm.dmi'
			special_light_key = "mmekaninja"
		else
			return FALSE
	return ..()

/obj/item/robot_module/ninja/do_transform_animation()
	..()
	to_chat(loc, span_userdanger("I am an elite mercenary assassin of the mighty Spider Clan. A <font color='red'><B>SPACE NINJA</B></font>!\
	Surprise is my weapon. Shadows are my armor. Without them, I am nothing."))

/obj/item/robot_module/ninja/respawn_consumable(mob/living/silicon/robot/R, coeff = 1)
	..()
	var/obj/item/gun/energy/e_gun/advtaser/cyborg/T = locate(/obj/item/gun/energy/e_gun/advtaser/cyborg) in basic_modules
	if(T)
		if(T.cell.charge < T.cell.maxcharge)
			var/obj/item/ammo_casing/energy/S = T.ammo_type[T.select]
			T.cell.give(S.e_cost * coeff)
			T.update_appearance()
		else
			T.charge_timer = 0
