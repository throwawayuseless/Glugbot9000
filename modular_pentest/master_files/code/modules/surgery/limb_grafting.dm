/datum/surgery_step/graft_limb
	implements = list(
		/obj/item/bodypart = 100,
		/obj/item/organ_storage = 100,
		/obj/item/gun/ballistic/shotgun/mounted = 100,
		/obj/item/chainsaw = 100,
		/obj/item/melee/synthetic_arm_blade = 100)


/datum/surgery_step/graft_limb/success(mob/user, mob/living/carbon/target, target_zone, obj/item/tool, datum/surgery/surgery, default_display_results = FALSE)
	..()
	if(!istype(tool, /obj/item/organ_storage) && !istype(tool, /obj/item/bodypart))
		var/obj/item/bodypart/L = target.new_body_part(target_zone, FALSE, FALSE)
		L.is_pseudopart = TRUE
		L.icon_state = null
		if(!L.attach_limb(target))
			display_results(user, target, span_warning("You fail in attaching [target]'s [parse_zone(target_zone)]! Their body has rejected [L]!"),
					span_warning("[user] fails to attach [target]'s [parse_zone(target_zone)]!"),
					span_warning("[user] fails to attach [target]'s [parse_zone(target_zone)]!"))
			L.forceMove(target.loc)
			return
		user.visible_message(span_notice("[user] finishes attaching [tool]!"), span_notice("You attach [tool]."))
		display_results(user, target, span_notice("You attach [tool]."),
				span_notice("[user] finishes attaching [tool]!"),
				span_notice("[user] finishes the attachment procedure!"))
		qdel(tool)
		if(istype(tool, /obj/item/gun/ballistic/shotgun/mounted))
			var/obj/item/gun/ballistic/shotgun/mounted/on/new_arm = new(target)
			target_zone == BODY_ZONE_R_ARM ? target.put_in_r_hand(new_arm) : target.put_in_l_hand(new_arm)
			return
